<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>New in 0.10.0 and 0.10.1</title>

<script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92528248-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-92528248-1');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="css/styles.css" type="text/css" />
<link rel="stylesheet" href="css/colors.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"><div class = mrgg>mrgsolve::blog</div></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="https://mrgsolve.github.io/vignettes">Vignettes</a>
</li>
<li>
  <a href="https://mrgsolve.github.io/blog">Blog</a>
</li>
<li>
  <a href="https://mrgsolve.github.io/learn.html">Learn</a>
</li>
<li>
  <a href="https://github.com/mrgsolve/blog">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://mrgsolve.github.io/user_guide">UserGuide</a>
</li>
<li>
  <a href="https://mrgsolve.github.io">mrgsolve.github.io</a>
</li>
<li>
  <a href="https://github.com/metrumresearchgroup/mrgsolve">
    <span class="fa fa-code fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->


<div id="header">



<h1 class="title toc-ignore">New in 0.10.0 and 0.10.1</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#steady-state"><span class="toc-section-number">2</span> Steady-state</a></li>
<li><a href="#house-is-now-exported"><span class="toc-section-number">3</span> house is now exported</a></li>
<li><a href="#select_sims"><span class="toc-section-number">4</span> select_sims</a></li>
<li><a href="#plot-from-character-vector-of-column-names"><span class="toc-section-number">5</span> Plot from character vector of column names</a></li>
<li><a href="#outvars"><span class="toc-section-number">6</span> outvars</a></li>
<li><a href="#improvements-to-event-objects"><span class="toc-section-number">7</span> Improvements to event objects</a></li>
<li><a href="#new-error-message"><span class="toc-section-number">8</span> New error message</a></li>
<li><a href="#steady-state-infusion"><span class="toc-section-number">9</span> Steady state infusion</a></li>
<li><a href="#access-model-information"><span class="toc-section-number">10</span> Access model information</a></li>
<li><a href="#access-compartment-numbers"><span class="toc-section-number">11</span> Access compartment numbers</a></li>
</ul>
</div>

<div id="introduction" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>This blog post shows some of the new features that came into mrgsolve starting with version <code>0.10.0</code> (October 2019) and <code>0.10.1</code> (February 2020). The purpose is to illustrate what is possible rather than detailed documentation.</p>
</div>
<div id="steady-state" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Steady-state</h1>
<p>This is a big topic, so I put together a <a href="steady-state.html">separate blog entry</a> to look at new features around steady state.</p>
</div>
<div id="house-is-now-exported" class="section level1" number="3">
<h1><span class="header-section-number">3</span> house is now exported</h1>
<p>Since the beginning, we have maintained a model <strong>inside mrgsolve itself</strong> that we call <code>house</code>. It’s a basic PKPD model that we use to test and demo. The interesting thing about this model is that it is compiled when mrgsolve is installed. So the model is always ready to go.</p>
<p>It use to be unexported so you would have to access the model like this:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> mrgsolve<span class="sc">:::</span><span class="fu">house</span>()</span></code></pre></div>
<p>The <code>:::</code> means that we go into the mrgsolve namespace to call the function that returns the model object.</p>
<p>Now, <code>house</code> is exported</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">house</span>()</span></code></pre></div>
</div>
<div id="select_sims" class="section level1" number="4">
<h1><span class="header-section-number">4</span> select_sims</h1>
<p>There is a series of dplyr-like functions that allow you to work on the simulation output object (<code>mrgsims</code>) while keeping it a simulation output object. Starting in version <code>0.10.1</code>, we have a <code>select_sims</code> function which allows you to select certain columns in the simulation object</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">mrgsim</span>(<span class="fu">house</span>(), <span class="fu">ev</span>(<span class="at">amt =</span> <span class="dv">100</span>))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>out </span></code></pre></div>
<pre><code>. Model:  housemodel 
. Dim:    482 x 7 
. Time:   0 to 120 
. ID:     1 
.     ID time    GUT  CENT  RESP    DV    CP
. 1:   1 0.00   0.00  0.00 50.00 0.000 0.000
. 2:   1 0.00 100.00  0.00 50.00 0.000 0.000
. 3:   1 0.25  74.08 25.75 48.68 1.287 1.287
. 4:   1 0.50  54.88 44.50 46.18 2.225 2.225
. 5:   1 0.75  40.66 58.08 43.61 2.904 2.904
. 6:   1 1.00  30.12 67.83 41.38 3.391 3.391
. 7:   1 1.25  22.31 74.74 39.58 3.737 3.737
. 8:   1 1.50  16.53 79.56 38.18 3.978 3.978</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">select_sims</span>(out, RESP, CP)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>out</span></code></pre></div>
<pre><code>. Model:  housemodel 
. Dim:    482 x 4 
. Time:   0 to 120 
. ID:     1 
.     ID time  RESP    CP
. 1:   1 0.00 50.00 0.000
. 2:   1 0.00 50.00 0.000
. 3:   1 0.25 48.68 1.287
. 4:   1 0.50 46.18 2.225
. 5:   1 0.75 43.61 2.904
. 6:   1 1.00 41.38 3.391
. 7:   1 1.25 39.58 3.737
. 8:   1 1.50 38.18 3.978</code></pre>
<p>Notice that <code>ID</code> and <code>time</code> are retained. The motivation here is to allow you to request many columns and then pare back so that, for example, plotting is more convenient</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out)</span></code></pre></div>
<p><img src="new-0-10-1_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Other functions include</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate_sims</span>(out, <span class="at">name =</span> <span class="st">&quot;kyle&quot;</span>)</span></code></pre></div>
<pre><code>. Model:  housemodel 
. Dim:    482 x 5 
. Time:   0 to 120 
. ID:     1 
.     ID time  RESP    CP name
. 1:   1 0.00 50.00 0.000 kyle
. 2:   1 0.00 50.00 0.000 kyle
. 3:   1 0.25 48.68 1.287 kyle
. 4:   1 0.50 46.18 2.225 kyle
. 5:   1 0.75 43.61 2.904 kyle
. 6:   1 1.00 41.38 3.391 kyle
. 7:   1 1.25 39.58 3.737 kyle
. 8:   1 1.50 38.18 3.978 kyle</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter_sims</span>(out, time <span class="sc">&gt;</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>. Model:  housemodel 
. Dim:    472 x 4 
. Time:   2.25 to 120 
. ID:     1 
.     ID time  RESP    CP
. 1:   1 2.25 35.84 4.312
. 2:   1 2.50 35.46 4.345
. 3:   1 2.75 35.22 4.355
. 4:   1 3.00 35.07 4.348
. 5:   1 3.25 34.99 4.329
. 6:   1 3.50 34.97 4.302
. 7:   1 3.75 34.98 4.267
. 8:   1 4.00 35.03 4.229</code></pre>
<p>Notice in all of these operations, the <code>mrgsims</code> object is returned. If you want to <code>mutate</code> or <code>select</code> and get a <code>tibble</code> back, then just call</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(out, <span class="at">name =</span> <span class="st">&quot;Kyle&quot;</span>)</span></code></pre></div>
<pre><code>. # A tibble: 482 × 5
.       ID  time  RESP    CP name 
.    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
.  1     1  0     50    0    Kyle 
.  2     1  0     50    0    Kyle 
.  3     1  0.25  48.7  1.29 Kyle 
.  4     1  0.5   46.2  2.23 Kyle 
.  5     1  0.75  43.6  2.90 Kyle 
.  6     1  1     41.4  3.39 Kyle 
.  7     1  1.25  39.6  3.74 Kyle 
.  8     1  1.5   38.2  3.98 Kyle 
.  9     1  1.75  37.1  4.14 Kyle 
. 10     1  2     36.4  4.25 Kyle 
. # … with 472 more rows</code></pre>
</div>
<div id="plot-from-character-vector-of-column-names" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Plot from character vector of column names</h1>
<p>The plot method has so far required you to enter a formula to select columns to plot</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">mrgsim</span>(<span class="fu">house</span>(), <span class="fu">ev</span>(<span class="at">amt =</span> <span class="dv">100</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out, CP<span class="sc">~</span>time)</span></code></pre></div>
<p><img src="new-0-10-1_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>This works well is many circumstances. The new feature here is that you can list the columns to plot as a character vector. Let’s mrgsolve determine what column to put on the x-axis</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="st">&quot;CP RESP GUT&quot;</span>)</span></code></pre></div>
<p><img src="new-0-10-1_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>The motivation came from simulations that I was doing where there were a lot of columns in the output and I had many different panel plots I wanted to make. It was helpful to select the columns in a character vector rather than typing out the formula</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">modlib</span>(<span class="st">&quot;pbpk&quot;</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">mrgsim</span>(mod, <span class="fu">ev</span>(<span class="at">amt =</span> <span class="dv">100</span>))</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>set1 <span class="ot">&lt;-</span> <span class="st">&quot;Aad Abo Abr Ahe&quot;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>set2 <span class="ot">&lt;-</span> <span class="st">&quot;Ave Are Ask Asp Ali Aki&quot;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out, set1)</span></code></pre></div>
<p><img src="new-0-10-1_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out, set2)</span></code></pre></div>
<p><img src="new-0-10-1_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
<p>As you expect with mrgsolve, there is no need to specify a real R vector for listing the column names. We’ll split a string on space or comma. For this feature, we’ll also split on newline (helpful when the names are very long or you just want some structure to the layout</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>set3 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="st">  Aad Abo Abr Ahe</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="st">  Ave Are Ask Asp Ali Aki</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out, set3)</span></code></pre></div>
<p><img src="new-0-10-1_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="outvars" class="section level1" number="6">
<h1><span class="header-section-number">6</span> outvars</h1>
<p>Query the model object for the names of variables that you could ask for in a simulation</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">outvars</span>(<span class="fu">house</span>())</span></code></pre></div>
<pre><code>. $cmt
. [1] &quot;GUT&quot;  &quot;CENT&quot; &quot;RESP&quot;
. 
. $capture
. [1] &quot;DV&quot; &quot;CP&quot;</code></pre>
<p>Some names are compartments, some are captured.</p>
</div>
<div id="improvements-to-event-objects" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Improvements to event objects</h1>
<p>To make an event object</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ev</span>(<span class="at">amt =</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>. Events:
.   time amt cmt evid
. 1    0 100   1    1</code></pre>
<p>We can reference names in the object during construction</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ev</span>(<span class="at">amt =</span> <span class="dv">100</span>, <span class="at">rate =</span> amt<span class="sc">/</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>. Events:
.   time amt rate cmt evid
. 1    0 100   50   1    1</code></pre>
<p>I can also access columns in the event object</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">ev</span>(<span class="at">amt =</span> <span class="dv">100</span>, <span class="at">rate =</span> amt<span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>rate</span></code></pre></div>
<pre><code>. [1] 33.33333</code></pre>
<p>And we have been able to mutate these objects for a while now</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">ev</span>(<span class="at">amt =</span> <span class="dv">100</span>) </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(x, <span class="at">rate =</span> amt <span class="sc">/</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>. Events:
.   time amt rate cmt evid
. 1    0 100   20   1    1</code></pre>
<p>Check out the <code>tinf</code> argument to say how long you want an infusion to last</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ev</span>(<span class="at">amt =</span> <span class="dv">100</span>, <span class="at">tinf =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>. Events:
.   time amt     rate cmt evid tinf
. 1    0 100 33.33333   1    1    3</code></pre>
</div>
<div id="new-error-message" class="section level1" number="8">
<h1><span class="header-section-number">8</span> New error message</h1>
<p>You might see this</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>dose <span class="ot">&lt;-</span> <span class="fu">ev</span>(<span class="at">amt =</span> <span class="dv">100</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">try</span>(<span class="fu">mrgsim</span>(dose, mod))</span></code></pre></div>
<pre><code>. Error : the first argument to mrgsim must be a model object</code></pre>
<p>Which just means you passed things in in the wrong order.</p>
</div>
<div id="steady-state-infusion" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Steady state infusion</h1>
<p>mrgsolve can now run a zero-order infusion to steady state. Set <code>amt</code> to 0, <code>rate</code> to something positive and <code>ss</code> to 1. We change <code>recsort</code> just to show that things start at steady state.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>ssinf <span class="ot">&lt;-</span> <span class="fu">ev</span>(<span class="at">amt =</span> <span class="dv">0</span>, <span class="at">rate =</span> <span class="dv">5</span>, <span class="at">ss =</span> <span class="dv">1</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mrgsim</span>(<span class="fu">house</span>(), <span class="at">event =</span> ssinf, <span class="at">recsort=</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> plot</span></code></pre></div>
<p><img src="new-0-10-1_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>You can also set <code>rate</code> to -1 if you are modeling the rate. But it can’t be set to <code>-2</code>.</p>
</div>
<div id="access-model-information" class="section level1" number="10">
<h1><span class="header-section-number">10</span> Access model information</h1>
<p>For a while, you could access model parameters with <code>$</code> operator</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">house</span>()</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>mod<span class="sc">$</span>CL</span></code></pre></div>
<pre><code>. [1] 1</code></pre>
<p>Now you can access initial compartment values</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>mod<span class="sc">$</span>RESP</span></code></pre></div>
<pre><code>. [1] 50</code></pre>
<p>And other goodies</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>mod<span class="sc">$</span>end</span></code></pre></div>
<pre><code>. [1] 120</code></pre>
</div>
<div id="access-compartment-numbers" class="section level1" number="11">
<h1><span class="header-section-number">11</span> Access compartment numbers</h1>
<p>Sometimes when writing a model, we would like to know the number of a compartment when we only know the name. There is a plugin to make that doable now</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>$CMT CENTRAL</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>$PLUGIN N_CMT</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>$MAIN</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span><span class="op">(</span>CMT<span class="op">==</span>N_CENTRAL<span class="op">)</span> <span class="op">{</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ......</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>

<hr>
<p>
  mrgsolve: <a href="https://mrgsolve.github.io">mrgsolve.github.io</a> | 
  metrum research group: <a href="https://metrumrg.com">metrumrg.com</a></p>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
